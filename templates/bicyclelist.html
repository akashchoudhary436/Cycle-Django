<title>Bicycle List</title>
{% extends 'base.html' %} {% block content %}

<body>
  <section style="background-color: #eee">
    <div class="container py-5">
      <div class="row">
        {% for prod in products %}

        <div class="col-md-12 col-lg-4 mb-4 mb-lg-0">
          <div class="card">
            <div class="d-flex justify-content-between p-3">
              <h4 class="mb-0 fw-bold">{{ prod.product_name }}</h4>
            </div>
            <img
              src="{{ prod.image.url }}"
              class="card-img-top"
              alt="{{ prod.product_name }}"
            />
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <p class="small"></p>
              </div>
              <div class="d-flex justify-content-between mb-3">
                <h5 class="mb-0">{{ prod.product_name }}</h5>
                <h5 class="text-dark mb-0">Rs: {{ prod.product_price }}</h5>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <p class="text-muted mb-0">
                  Available:
                  <span class="fw-bold">{{ prod.product_quantity }}</span>
                </p>
                <div class="ms-auto text-warning">
                  <a class="btn btn-primary" href="{% url 'checkout' %}?product={{ prod.id }}" role="button">Add to Cart</a>
                  <button id="pr{{prod.id}}{{ forloop.counter }}" class="btn btn-primary cart">Add To Cart</button>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>
</body>

<script src="https://code.jquery.com/jquery-3.3.1.js"
integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script>
  console.log('working');
  if(localStorage.getItem('cart') == null){
    var cart = {};

  }
  else{
    cart = JSON.parse(localStorage.getItem('cart'));
  }


  $('.cart').click(function(){
  console.log('clicked');
  var idstr = this.id.toString();
  console.log(idstr);
  if (cart[idstr] !=undefined){
  cart[idstr] = cart[idstr] + 1;
  }
  else
  {
    cart[idstr] = 1;
  }
  console.log(cart);
  localStorage.setItem('cart',JSON.stringify(cart));
  document.getElementById('cart').innerHTML = Object.keys(cart).length;  
  });
  


</script>


{% endblock %}
